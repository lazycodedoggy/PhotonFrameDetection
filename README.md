![](https://img.shields.io/badge/language-python-orange.svg)
![License](https://img.shields.io/badge/License-MIT-blue.svg)
<img src="https://img.shields.io/github/last-commit/lazycodedoggy/PhotonFrameDetection" alt="last-commit" />

# Background

The project is a traditional AI vision recognition program designed to intelligently analyze dual-channel TIF files generated by two-photon microscopy imaging systems. It automatically annotates the start and end frames of three characteristic parameters—stratum corneum, cell density, and DEJI & epidermal thickness—within each TIF file, significantly saving time on manual analysis and annotation.

The project involves fine-tuning a pre-trained VGG16 model using about one hundred manually annotated datasets. The stratum corneum feature recognition is trained and fine-tuned separately (yielding better results), while cell density and DEJI & epidermal thickness feature recognition are trained and fine-tuned simultaneously. As a result, the accuracy and regression rate of recognizing these three characteristic parameters exceed 95% in the test dataset.

# Usage

1. `prepare-data.ipynb`: Pre-process the training dataset. You can modify the `processSingleInspectSheet` function to adapt to your own manual annotation logic.
2. `singlelabel-training.ipynb`: Train the stratum corneum feature detection.
3. `multlabels-training.ipynb`: Train the cell density and DEJI & epidermal thickness feature detection.
4. `inference.py`: Infer the start and end frames of the three characteristic parameters.

You can also use the following instruction to generate a Windows command line program for model inference on systems without a PyTorch environment.

```
pyinstaller -F inference.py PhotonDataset.py -i favicon.ico
```

Execute the command as follow for inference:

```
inference.exe -i <tif_path1> -i <tif_path2> -o <outputfile>
```

# Others

For any question, welcome to contact the email stephen4sheng@gmail.com or wx: ahuatian655418
